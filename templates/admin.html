<!doctype html>
<html>

<head>
    <title>Crawler Admin</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">

    <script src="{{ url_for('static', filename='js/npm_charts.js') }}"></script>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
    <style>
        /* CSS from admin.css (Simulated) */
    </style>

</head>

<body>
    <h1>Web Crawler Admin</h1>

    <form method="POST" action="{{ url_for('add_to_queue') }}">
        <label for="start_url">Start URL:</label>
        <input type="text" id="start_url" name="start_url" required>

        <label for="max_depth">Max depth:</label>
        <input type="number" id="max_depth" name="max_depth" value="2" min="1" required>

        <input type="submit" value="Add to Queue">
    </form>

    {% if message %}
    <p class="message">{{ message }}</p>
    {% endif %}

    <div class="button-controls">
        <button id="pause-btn" onclick="pauseCrawl()">Pause Crawl</button>
        <button id="resume-btn" onclick="resumeCrawl()">Resume Crawl</button>
    </div>

    <div class="stats-box">
        <p id="refresh-explain">Statistics refresh every 5 seconds.</p>

        <div id="crawler-status-container">
            Crawler Status: <span id="crawler-status">Loading...</span>
            <span id="pause-status">...</span>
        </div>

        <div>Current queue size (pending items): <span id="queue-size">Loading...</span></div>
        <div>Crawled items: <span id="crawled-items">Loading...</span></div>
        <div>Failed items: <span id="failed-items">Loading...</span></div>
        <div>Media items: <span id="media-items">Loading...</span></div>
        <br>

    </div>


    <div id="chartSection">
        <div id="chartContainer">
            <canvas id="crawledChart"></canvas> <!--Total amount of crawled pages-->
            <canvas id="pendingChart"></canvas> <!--Total amount of pages in the queue waiting to be processed-->
            <canvas id="crawledRateChart"></canvas> <!--Rate of crawled pages /min-->
            <canvas id="pendingRateChart"></canvas> <!--Rate of page changes in queue-->
        </div>
    </div>
    
    <label class="dropdown-toggle" for="dropdown-checkbox">
        ▼ Show Extra Sections
    </label>
    <input type="checkbox" id="dropdown-checkbox" hidden>

    <div class="dropdown-content">
        <div class="stats-box">
            <div class="chart-info">
                <p><strong>Crawled pages</strong><br>
                    <small style="color:#aaaaaa;">Cumulative total of pages successfully downloaded and processed since
                        the
                        crawler started or was last reset.</small>
                </p>
            </div>

            <!-- After <canvas id="pendingChart"> -->
            <div class="chart-info">
                <p><strong>Pending pages</strong><br>
                    <small style="color:#aaaaaa;">Current size of the queue — pages discovered but not yet crawled. This
                        is the
                        backlog.</small>
                </p>
            </div>

            <!-- After <canvas id="crawledRateChart"> -->
            <div class="chart-info">
                <p><strong>Crawled pages / minute</strong><br>
                    <small style="color:#aaaaaa;">Real-time crawling speed. Shows how many pages your crawler is
                        successfully
                        processing per minute right now (green = healthy and fast).</small>
                </p>
            </div>

            <!-- After <canvas id="pendingRateChart"> -->
            <div class="chart-info">
                <p><strong>Pending queue change / minute</strong><br>
                    <small style="color:#aaaaaa;">Rate at which the queue is growing or shrinking.<br>
                        • Positive (orange line up) = discovering new URLs faster than crawling → queue growing<br>
                        • Negative (orange line down) = crawler is winning → queue shrinking<br>
                        • Near zero = steady state (balanced)</small>
                </p>
            </div>
        </div>

    </div>

</body>

</html>